const jwt=require("jsonwebtoken"),verificarToken=(req,res,next)=>{const authHeader=req.headers.authorization,token=authHeader&&authHeader.split(" ")[1];if(!token)return res.status(401).json({error:"Acceso denegado. No se proporcionó token."});try{const payload=jwt.verify(token,process.env.JWT_SECRET);req.usuarioId=payload.id,next()}catch(error){return"TokenExpiredError"===error.name?res.status(401).json({error:"Token expirado."}):(console.error("Error al verificar token:",error),res.status(403).json({error:"Token inválido."}))}};module.exports=verificarToken;
const{PrismaClient:PrismaClient}=require("@prisma/client"),prisma=new PrismaClient,verificarRol=rolesPermitidos=>async(req,res,next)=>{const usuarioId=req.usuarioId;try{const usuario=await prisma.usuario.findUnique({where:{id:usuarioId},select:{rol:!0}});if(!usuario)return res.status(404).json({error:"Usuario no encontrado."});if(!rolesPermitidos.includes(usuario.rol))return res.status(403).json({error:"Acceso denegado. No tienes los permisos necesarios."});next()}catch(error){console.error("Error al verificar rol:",error),res.status(500).json({error:"Error interno del servidor."})}};module.exports=verificarRol;